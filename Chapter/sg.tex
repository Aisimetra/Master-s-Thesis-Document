\section{Result for Savitzky–Golay filter} \label{cap:ResultSG}

The result presented in this section are denoised with Savitzky–Golay filter and are
 divided into normal bed, section \ref{cap:normalSavitz}, and rocking bed \ref{cap:RockSavitx}. Inside both sections are presented the result for each position for the binary and weighted approach.


%%%%%% NORMAL BED %%%%%%
\subsection{Normal Bed} \label{cap:normalSavitz}

The participant in this phase has to perform a series of jumps before lying on the mattress due to recreating the increase or decrease of the breath rate between the different sleep stages. This phase aims to understand the feasibility of extracting breath rate from the mat. For this phase, the mattress is placed on a standard bed.

%%%%%% NORMAL BED - SUPINE %%%%%%

\subsubsection{Result Normal Bed in Supine Position}  
The estimated respiratory rate per minute (rpm) while the participants are supine with the mattress placed on a normal bed is further presented. Table \ref{tab:SupineNormalStillsg} presented the estimated rpm using binary and weighted approach compared with the rpm given by the ground truth. The approaches retrieve an almost identical rpm, this result may be due to the choice of the minimum confidence value at 80\% that allows keeping only the best signal, maybe with higher confidence can be seen a higher difference between the two approaches. 

\vspace{0.5cm}
\input{Chapter/metrics/SG_back_still.tex}

Table \ref{tab:SupineNormalStillMetricssg} present the average rpm for both approaches  
and the relative mean absolute error (MAE) and mean absolute percentage error (MAPE). As just discussed in the previous paragraph there is no substantial difference between the two different approaches. The data on which to focus more is the number of breaths that the algorithm misses, represented by MAE and expressed in percentage by MAPE. The average number is 2rpm, which means that if we consider the estimated average of 14.5rpm the error is almost 20\%, quite high for an approach that must be used in the medical field.

%\vspace{0.5cm}
\input{Chapter/metrics/SupineMetricssg.tex}

Figure \ref{fig:baln1} show the Bland–Altman plot, presented in section \ref{cap:plottino}, of the estimated rpm from the pipeline compared to the value of the ground truth. It helps to visualize the data from Table \ref{tab:SupineNormalStillMetricssg} in respect of the error. Since the result for the approaches is similar the data presented with this plot refers to the weighted approach only.

Figure \ref{fig:rec} shows the denoised signal using MODWTMRA with the highest accuracy (92\%) for the supine position with a normal mattress.

\begin{figure}[p]
  \centering
  \includegraphics[width=\textwidth]{img/balnd1.pdf}

  \caption{Bland Altman Plot of estimated rpm from the pipeline compared to the value of the ground truth - Normal bed and supine position}
  \label{fig:baln1}
  \vspace{1.5cm}
  \includegraphics[width=\textwidth]{img/404.jpg}
  \includegraphics[width=\textwidth]{img/404_wave.jpg}
\caption{Raw data and denoised signal using MODWTMRA of the channel with the highest percentage of confidence (92\%) - Normal bed and supine position}
  \label{fig:rec}
\end{figure}


\clearpage
%%%%%% Rocking  Bed %%%%%%
\subsection{Rocking Bed}\label{cap:RockSavitx}
The second part of the data collection aims to understand if the movement of the
rocking bed could influence the signal. The participant has to lie on the mattress without jumps, to have less variability in the data. For this phase, the mattress is placed on a rocking bed, which periods have been fixed at 4 seconds (15 periods in a minute) with an acceleration of 0.25 $m/s^2$.


%%%%%% Rocking BED - SUPINE %%%%%%

\subsubsection{Result Rocking Bed in Supine Position}  % \label{cap:ResultNormalBed1}

The estimated respiratory rate per minute (rpm) while the participants are supine with the mattress placed on a rocking bed is further presented. 

Table \ref{tab:SupineMovsg} presented the estimated rpm using binary and weighted approach compared with the rpm given by the ground truth. The approaches retrieve an almost identical rpm. 

\vspace{0.5cm}
\input{Chapter/metrics/SG_back_mov.tex}

Table \ref{tab:SupineMovsg} present the average rpm for both approaches  
and the relative mean absolute error (MAE) and mean absolute percentage error (MAPE). As just discussed in the previous paragraph there is no substantial difference between the two different approaches. The data on which to focus more is the number of breaths that the algorithm misses, represented by MAE and expressed in percentage by MAPE. The average number is 3rpm, which means that if we consider the estimated average of 15.1rpm the error is almost 25\%, is too high for an approach that must be used in the medical field.

%\vspace{0.5cm}
\input{Chapter/metrics/SupineMovMetricssg.tex}

Figure \ref{fig:baln1} show the Bland–Altman plot, presented in section \ref{cap:plottino}, of the estimated rpm from the pipeline compared to the value of the ground truth. It helps to visualize the data from Table \ref{tab:SupineRockingMetricssg} in respect of the error. Since the result for the approaches is similar the data presented with this plot refers to the weighted approach only.

Figure \ref{fig:rec} shows the denoised signal using MODWTMRA with the highest accuracy (92\%) for the supine position with a normal mattress.

\begin{figure}[p]
  \centering
  \includegraphics[width=\textwidth]{img/balnd1.pdf}

  \caption{Bland Altman Plot of estimated rpm from the pipeline compared to the value of the ground truth - Rocking bed and supine position}
  \label{fig:baln1}
  \vspace{1.5cm}
  \includegraphics[width=\textwidth]{img/404.jpg}
  \includegraphics[width=\textwidth]{img/404_wave.jpg}
\caption{Raw data and denoised signal using MODWTMRA of the channel with the highest percentage of confidence (92\%) - Normal bed and supine position}
  \label{fig:rec}
\end{figure}
